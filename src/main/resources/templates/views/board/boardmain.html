<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout}">

<head>
<th:block layout:fragment="css">
	<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
	font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
}

.container {
	width: 375px;
	background-color: white;
	min-height: 90vh;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	position: relative;
}

/* Top search bar styles */
.search-bar {
	display: flex;
	align-items: center;
	padding: 10px 15px;
	border-bottom: 1px solid #e0e0e0;
	transition: transform 0.3s ease;
}

.search-bar.hidden {
	transform: translateY(-100%);
}

.search-options {
	display: flex;
	align-items: center;
	gap: 10px;
	flex-grow: 1;
}

.search-option {
	font-size: 14px;
	font-weight: bold;
	color: #000;
	cursor: pointer;
}

.search-option.inactive {
	color: #888;
}

.search-tag {
	width: 25px;
	height: 25px;
	background-color: transparent;
	border: none;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
}

/* Category tabs styles */
.category-tabs {
	display: flex;
	background-color: #fff;
	border-bottom: 1px solid #e0e0e0;
	position: sticky;
	top: 0;
	z-index: 10;
}

.category-tab {
	flex: 1;
	text-align: center;
	padding: 12px 0;
	font-size: 14px;
	color: #666;
	background: transparent;
	border: none;
	cursor: pointer;
}

.category-tab.active {
	color: #000;
	font-weight: bold;
	background-color: #E6EEF0;
}

.post-user {
	display: flex;
	align-items: center;
	padding: 10px;
}

.post-user-image {
	width: 40px;
	height: 40px;
	border-radius: 50%;
	margin-right: 10px;
	background-color: #ddd;
	overflow: hidden;
	cursor: pointer;
}

.post-user-image img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.post-user-info {
	flex-grow: 1;
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.post-user-details {
	display: flex;
	flex-direction: column;
}

.post-user-name {
	font-weight: bold;
}

.post-user-follower {
	color: #999;
	font-size: 12px;
}

.follow-button {
	background-color: #065F79;
	color: white;
	border: none;
	border-radius: 4px;
	padding: 5px 10px;
	font-size: 12px;
	cursor: pointer;
}

.post-image {
	width: 100%;
	max-height: 500px;
	object-fit: cover;
}

.post-actions {
	display: flex;
	justify-content: space-between;
	padding: 10px;
	border-bottom: 1px solid #e0e0e0;
}

.post-action-buttons {
	display: flex;
	gap: 15px;
}

.post-action-buttons button {
	background: none;
	border: none;
	display: flex;
	align-items: center;
	gap: 5px;
	font-size: 14px;
	cursor: pointer;
}

.post-caption {
	padding: 10px;
	font-size: 14px;
}

.hashtags-container {
	padding: 0 10px 10px;
	display: flex;
	flex-wrap: wrap;
	gap: 8px;
}

.hashtag {
	padding: 4px 10px;
	color: #8B8B8B;
	font-size: 12px;
	font-weight: 600;
	border-radius: 5px;
	background-color: #EFEFEF;
	display: inline-block;
}

/* Profile Modal Styles */
.profile-modal {
	position: fixed;
	bottom: 40px;
	left: 0;
	right: 0;
	margin: 0 auto;
	max-width: 375px;
	background-color: #f3f9fb;
	border-top-left-radius: 20px;
	border-top-right-radius: 20px;
	z-index: 100;
	box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
	display: none;
}

.profile-modal.show {
	display: block;
}

.profile-modal-header {
	display: flex;
	justify-content: flex-end;
	padding: 10px;
}

.close-button {
	background: none;
	border: none;
	font-size: 20px;
	color: #888;
	cursor: pointer;
}

.profile-modal-content {
	padding: 10px 20px 20px;
	text-align: center;
}

.profile-image-large {
	width: 80px;
	height: 80px;
	border-radius: 50%;
	margin: 0 auto 15px;
	overflow: hidden;
	background-color: #ddd;
}

.profile-image-large img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.profile-name {
	font-size: 18px;
	font-weight: bold;
	margin-bottom: 5px;
}

.profile-description {
	color: #888;
	font-size: 14px;
	margin-bottom: 20px;
}

.profile-stats {
	display: flex;
	justify-content: center;
	border-top: 1px solid #e0e0e0;
	border-bottom: 1px solid #e0e0e0;
	padding: 15px 0;
	margin-bottom: 20px;
}

.stat {
	flex: 1;
	text-align: center;
}

.stat-number {
	font-size: 18px;
	font-weight: bold;
}

.stat-label {
	font-size: 12px;
	color: #888;
}

.profile-actions {
	display: flex;
	justify-content: center;
	gap: 10px;
	margin-bottom: 20px;
}

.action-button {
	background-color: #f0f0f0;
	border: none;
	border-radius: 20px;
	padding: 8px 15px;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
}

.bottom-nav-modal {
	display: flex;
	justify-content: space-around;
	padding: 10px 0;
	border-top: 1px solid #e0e0e0;
}

.bottom-nav-item {
	text-align: center;
	flex: 1;
	cursor: pointer;
}

.bottom-nav-item svg {
	margin-bottom: 5px;
}

.bottom-nav-text {
	font-size: 10px;
	color: #888;
}

.bottom-nav-item.active .bottom-nav-text {
	color: #000;
}

.modal-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.5);
	z-index: 99;
	display: none;
}

.modal-overlay.show {
	display: block;
}

/* ëŒ“ê¸€ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
.comments-modal {
	position: fixed;
	bottom: 70px;
	left: 0;
	right: 0;
	margin: 0 auto;
	max-width: 375px;
	height: 70vh;
	background-color: white;
	border-top-left-radius: 20px;
	border-top-right-radius: 20px;
	z-index: 100;
	box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
	display: none;
	flex-direction: column;
}

.comments-modal.show {
	display: flex;
}

.comments-modal-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 15px;
	border-bottom: 1px solid #e0e0e0;
}

.comments-title {
	font-weight: bold;
	flex-grow: 1;
	text-align: center;
}

.comments-list {
	flex-grow: 1;
	overflow-y: auto;
	padding: 10px 0;
}

.comment-item {
	display: flex;
	padding: 10px 15px;
}

.comment-user-image {
	width: 36px;
	height: 36px;
	border-radius: 50%;
	margin-right: 10px;
	background-color: #ddd;
	overflow: hidden;
}

.comment-user-image img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.comment-content {
	flex-grow: 1;
}

.comment-user-name {
	font-weight: bold;
	margin-bottom: 2px;
}

.comment-text {
	font-size: 14px;
	line-height: 1.4;
}

.comment-time {
	font-size: 12px;
	color: #888;
	margin-top: 3px;
}

.comment-actions {
	display: flex;
	gap: 15px;
	margin-top: 5px;
	font-size: 12px;
	color: #888;
}

.comment-like, .comment-reply {
	cursor: pointer;
}

.comment-input-container {
	display: flex;
	align-items: center;
	padding: 10px 15px;
	border-top: 1px solid #e0e0e0;
	background-color: white;
}

.comment-user-image-small {
	width: 32px;
	height: 32px;
	border-radius: 50%;
	margin-right: 10px;
	background-color: #ddd;
	overflow: hidden;
}

.comment-user-image-small img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.comment-input-wrapper {
	flex-grow: 1;
	display: flex;
	align-items: center;
	border-radius: 20px;
	background-color: #f0f0f0;
	padding: 8px 15px;
}

.comment-input {
	flex-grow: 1;
	border: none;
	background: transparent;
	outline: none;
	font-size: 14px;
}

.emoji-button {
	background: none;
	border: none;
	font-size: 16px;
	color: #888;
	padding: 0;
	margin-right: 10px;
	cursor: pointer;
}

.comment-submit {
	color: #065F79;
	font-weight: bold;
	font-size: 14px;
	background: none;
	border: none;
	padding: 0 5px;
	cursor: pointer;
}

.comment-submit:disabled {
	color: #ccc;
	cursor: default;
}

/* ì´ëª¨ì§€ ì„ íƒê¸° */
.emoji-selector {
	display: flex;
	justify-content: space-between;
	padding: 10px 15px;
	background-color: #f8f8f8;
	border-top: 1px solid #e0e0e0;
	overflow-x: auto;
	white-space: nowrap;
}

.emoji-item {
	font-size: 24px;
	margin: 0 5px;
	cursor: pointer;
}
.like-button.liked svg path {
    fill: red;
    stroke: red;
}
</style>
</th:block>
</head>
<body>
	<!-- HTML ë ˆì´ì•„ì›ƒ ë¶€ë¶„ -->
	<div layout:fragment="content">
		<div class="container">
			<!-- í”¼ë“œ ìƒë‹¨ íƒìƒ‰ ì˜ì—­ -->
			<div class="search-bar">
				<div class="search-options">
					<span class="search-option active" id="allFeed">ì „ì²´</span> <span
						class="search-option inactive" id="followingFeed">íŒ”ë¡œì‰</span> <span
						class="search-option inactive" id="popularFeed">ì¸ê¸°</span>
				</div>
				<button class="search-tag">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24" fill="none" stroke="currentColor"
						stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                       <circle cx="11" cy="11" r="8"></circle>
                       <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                   </svg>
				</button>
			</div>

			<!-- ì¹´í…Œê³ ë¦¬ íƒ­ -->
			<div class="category-tabs">
				<button class="category-tab active">ì „ì²´</button>
				<button class="category-tab">ì‹ë‹¨</button>
				<button class="category-tab">ë ˆì‹œí”¼</button>
				<button class="category-tab">ìš´ë™</button>
				<button class="category-tab">ëˆˆë°”ë””</button>
			</div>

			<!-- ê²Œì‹œë¬¼ ì»¨í…Œì´ë„ˆ -->
			<div id="postsContainer"></div>
		</div>

		<!-- ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ -->
		<div class="modal-overlay" id="profilemodalOverlay"></div>
		<div class="modal-overlay" id="commentmodalOverlay"></div>

		<!-- í”„ë¡œí•„ ëª¨ë‹¬ -->
		<div class="profile-modal" id="profileModal">
			<div class="profile-modal-header">
				<!-- ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ -->
				<button class="close-button" id="closeModalButton">Ã—</button>
			</div>
			<div class="profile-modal-content">
				<div class="profile-image-large">
					<img src="" alt="Profile">
				</div>
				<div class="profile-name">ì›ìˆ­ì´ëŠ”ê·€ì—¬ì›Œ</div>
				<div class="profile-description">ë‹¤ê°™ì´ ê³ ë¦´ë¼</div>

				<div class="profile-stats">
					<div class="stat">
						<div class="stat-number">15</div>
						<div class="stat-label">ë³´ìœ  íŒ”ë¡œì›Œ ìˆ˜</div>
					</div>
					<div class="stat">
						<div class="stat-number">43</div>
						<div class="stat-label">ì¹œêµ¬ ìˆ˜</div>
					</div>
				</div>

				<div class="profile-actions">
					<button class="action-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
							viewBox="0 0 24 24" fill="none" stroke="currentColor"
							stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                           <path
								d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                           <circle cx="8.5" cy="7" r="4"></circle>
                           <line x1="20" y1="8" x2="20" y2="14"></line>
                           <line x1="23" y1="11" x2="17" y2="11"></line>
                       </svg>
					</button>
					<button class="action-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
							viewBox="0 0 24 24" fill="none" stroke="currentColor"
							stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                           <path
								d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                       </svg>
					</button>
				</div>
			</div>
		</div>

		<!-- ëŒ“ê¸€ ëª¨ë‹¬ -->
		<div class="comments-modal" id="commentsModal">
			<div class="comments-modal-header">
				<!-- ëŒ“ê¸€ ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ -->
				<button class="close-button" id="closeCommentsButton">Ã—</button>
				<div class="comments-title">ëŒ“ê¸€</div>
				<div style="width: 20px;"></div>
				<!-- ìš°ì¸¡ ì—¬ë°±ìš© -->
			</div>

			<div class="comments-list" id="commentsList">
				<!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ëŠ” ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
			</div>

			<!-- ì´ëª¨ì§€ ì„ íƒê¸° -->
			<div class="emoji-selector">
				<span class="emoji-item">â¤ï¸</span> <span class="emoji-item">ğŸ™Œ</span>
				<span class="emoji-item">ğŸ”¥</span> <span class="emoji-item">ğŸ‘</span>
				<span class="emoji-item">ğŸ˜¢</span> <span class="emoji-item">ğŸ˜</span>
				<span class="emoji-item">ğŸ˜®</span> <span class="emoji-item">ğŸ˜‚</span>
			</div>

			<!-- ëŒ“ê¸€ ì…ë ¥ ì˜ì—­ -->
			<div class="comment-input-container">
				<div class="comment-user-image-small">
					<img src="/images/default-profile.jpg" alt="Your Profile">
				</div>
				<div class="comment-input-wrapper">
					<input type="text" class="comment-input" id="commentInput"
						placeholder="ëŒ“ê¸€ ë‹¬ê¸°...">
					<button class="comment-submit" id="submitComment" disabled>ê²Œì‹œ</button>
				</div>
			</div>
		</div>
	</div>

	<!-- JavaScript ë¶€ë¶„ -->
	<th:block layout:fragment="script">
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script>
	
    $(document).ready(function() {
        // í˜„ì¬ ì„ íƒëœ ê²Œì‹œë¬¼ ID (ëŒ“ê¸€ ê¸°ëŠ¥ì— ì‚¬ìš©)
        let currentPostId = null;

        // === í”„ë¡œí•„ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ ===
        function openProfileModal(userData) {
            $('#profileModal .profile-image-large img').attr('src', '/images/' + userData.profileImage);
            $('#profileModal .profile-name').text(userData.nickname);
            $('#profileModal .profile-description').text(userData.description || 'ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤');
            $('#profileModal .profile-stats .stat:nth-child(1) .stat-number').text(userData.followersCount || 0);
            $('#profileModal .profile-stats .stat:nth-child(2) .stat-number').text(userData.friendsCount || 0);

            $('#profileModal').addClass('show');
            $('#profilemodalOverlay').addClass('show');
            document.body.style.overflow = 'hidden'; // ëª¨ë‹¬ ì—´ë¦´ ë•Œ ìŠ¤í¬ë¡¤ ë°©ì§€
        }

        function closeModal() {
            $('#profileModal').removeClass('show');
            $('#profilemodalOverlay').removeClass('show');
            document.body.style.overflow = 'auto'; // ìŠ¤í¬ë¡¤ ë‹¤ì‹œ í™œì„±í™”
        }

        // === ëŒ“ê¸€ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ ===
        function openCommentsModal(postId) {
            currentPostId = postId;
            loadComments(postId);

            if ($('#profileModal').hasClass('show')) {
                closeModal();
            }

            $('#commentsModal').addClass('show');
            $('#commentmodalOverlay').addClass('show');
            document.body.style.overflow = 'hidden'; // ëª¨ë‹¬ ì—´ë¦´ ë•Œ ìŠ¤í¬ë¡¤ ë°©ì§€

            setTimeout(() => {
                $('#commentInput').focus();
            }, 300);
        }

        function closeCommentsModal() {
            $('#commentsModal').removeClass('show');
            $('#commentmodalOverlay').removeClass('show');
            document.body.style.overflow = 'auto'; // ìŠ¤í¬ë¡¤ ë‹¤ì‹œ í™œì„±í™”
            currentPostId = null; // í˜„ì¬ ê²Œì‹œë¬¼ ID ë¦¬ì…‹
        }

        function loadComments(postId) {
            $.ajax({
                url: '/api/comments/' + postId,
                method: 'GET',
                success: function(data) {
                    $('#commentsList').empty();
                    if (data && data.comments && data.comments.length > 0) {
                        data.comments.forEach(comment => {
                            const commentHtml = `
                                <div class="comment-item">
                                    <div class="comment-user-image">
                                        <img src="/images/${comment.user.profileImage}" alt="Profile">
                                    </div>
                                    <div class="comment-content">
                                        <div class="comment-user-name">${comment.user.nickname}</div>
                                        <div class="comment-text">${comment.comment}</div>
                                        <div class="comment-time">${comment.createdAt}</div>
                                        <div class="comment-actions">
                                            <span class="comment-reply">ë‹µê¸€ ë‹¬ê¸°</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                            $('#commentsList').append(commentHtml);
                        });
                    } else {
                        $('#commentsList').append('<div class="no-comments">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('ëŒ“ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                }
            });
        }

        // === ê²Œì‹œë¬¼ ë¡œë”© í•¨ìˆ˜ ===
        function loadPosts() {
            $.ajax({
                url: '/api/with-details',
                method: 'GET',
                success: function(data) {
                    $('#postsContainer').empty();

                    data.forEach(post => {
                        const postHtml = `
                            <div class="post-container" data-post-id="${post.id}">
                                <div class="post-user">
                                    <div class="post-user-image post-profile-trigger" data-user='${JSON.stringify(post.user)}'>
                                        <img src="${post.user.profileImage != null && post.user.profileImage != '' ? post.user.profileImage : '/images/default-profile.jpg'}" 
                                             alt="Profile"
                                             onerror="this.src='/images/default-profile.jpg'">
                                    </div>
                                    <div class="post-user-info">
                                        <div class="post-user-details">
                                            <div class="post-user-name">${post.user.nickname}</div>
                                            <div class="post-user-follower">íŒ”ë¡œì›Œ ${post.user.followersCount || 0}</div>
                                        </div>
                                        <button class="follow-button" data-user-id="${post.user.id}">íŒ”ë¡œìš°</button>
                                    </div>
                                </div>
                                ${post.images.map(image => `
                                    <img src="/images/${image.fileName}" alt="Post Image" class="post-image">
                                `).join('')}
                                <div class="post-actions">
                                    <div class="post-action-buttons">
                                    <button class="like-button ${post.likedByCurrentUser ? 'liked' : ''}" data-post-id="${post.id}" data-liked="${post.likedByCurrentUser}">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                            </svg>
                                           <span> ${post.likesCount || 0}</span>
                                        </button>
                                        <button class="comment-button">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                                            </svg>
                                            ${post.commentCount || 0}
                                        </button>
                                    </div>
                                </div>
                                <div class="post-caption">${post.content}</div>
                                <div class="hashtags-container">
                                    ${post.hashtags ? post.hashtags.map(tag => `<span class="hashtag">#${tag}</span>`).join(' ') : '<span class="hashtag">#ìš´ë™</span> <span class="hashtag">#ì¼ìƒ</span>'}
                                </div>
                            </div>
                        `;
                        $('#postsContainer').append(postHtml);
                    });

                    attachEventHandlers();
                },
                error: function(xhr, status, error) {
                    console.error('ê²Œì‹œë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                }
            });
        }

        function attachEventHandlers() {
            // ëŒ“ê¸€ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            $('.comment-button').on('click', function() {
                const postId = $(this).closest('.post-container').data('post-id');
                openCommentsModal(postId);
            });

            // í”„ë¡œí•„ ì´ë¯¸ì§€ í´ë¦­ ì´ë²¤íŠ¸
            $('.post-profile-trigger').on('click', function() {
                const userData = $(this).data('user');
                openProfileModal(userData);
            });

            // === ëŒ“ê¸€ ì…ë ¥ ê´€ë ¨ ì´ë²¤íŠ¸ ===
            // ì´ëª¨ì§€ ì„ íƒê¸° ì´ë²¤íŠ¸
            $('.emoji-item').on('click', function() {
                const emoji = $(this).text();
                $('#commentInput').val($('#commentInput').val() + emoji);
                $('#commentInput').focus();
                $('#submitComment').prop('disabled', !$('#commentInput').val().trim());
            });

            // ëŒ“ê¸€ ì…ë ¥ ì´ë²¤íŠ¸ ì²˜ë¦¬
            $('#commentInput').on('input', function() {
                $('#submitComment').prop('disabled', !$(this).val().trim());
            });

            // ëŒ“ê¸€ ì œì¶œ ì²˜ë¦¬
            $('#submitComment').on('click', function() {
                const commentText = $('#commentInput').val().trim();
                if (!commentText || !currentPostId) return;

                const newComment = {
                    boardId: currentPostId,
                    userId: 2, // ì‹¤ì œ ì‚¬ìš©ì IDë¥¼ ë„£ì–´ì•¼ í•©ë‹ˆë‹¤.
                    comment: commentText
                };

                $.ajax({
                    url: '/api',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(newComment),
                    success: function() {
                        $('#commentInput').val('');
                        $('#submitComment').prop('disabled', true);
                        loadComments(currentPostId); // ëŒ“ê¸€ ëª©ë¡ ê°±ì‹ 
                    },
                    error: function(xhr, status, error) {
                        console.error('ëŒ“ê¸€ ì¶”ê°€ ì‹¤íŒ¨:', error);
                    }
                });
            });

            // Enter í‚¤ë¡œ ëŒ“ê¸€ ì…ë ¥
            $('#commentInput').on('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey && !$('#submitComment').prop('disabled')) {
                    e.preventDefault();
                    $('#submitComment').click();
                }
            });

            // í”„ë¡œí•„ ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            $('#closeModalButton').on('click', closeModal);

            // ëŒ“ê¸€ ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            $('#closeCommentsButton').on('click', closeCommentsModal);

            $('.like-button').on('click', function () {
                const likeButton = $(this);
                const postId = likeButton.data('post-id');
                let liked = likeButton.data('liked') === true || likeButton.data('liked') === 'true'; // ë¬¸ìì—´ 'true' ëŒ€ì‘

                // ì„œë²„ì— ì¢‹ì•„ìš” ìš”ì²­
                $.ajax({
                    url: `/api/${postId}/like-toggle`,
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        userId: 2 // ì‹¤ì œ ë¡œê·¸ì¸ ì‚¬ìš©ì ID
                    }),
                    success: function (response) {
                        // ì„œë²„ì—ì„œ ì‘ë‹µìœ¼ë¡œ likesCount, liked(boolean) ë°˜í™˜í•œë‹¤ê³  ê°€ì •
                        likeButton.find('span').text(response.likesCount);
                        likeButton.data('liked', response.liked);

                        // ì¢‹ì•„ìš” ìƒíƒœì— ë”°ë¼ ì•„ì´ì½˜ ìƒ‰ìƒ ë³€ê²½
                        if (response.liked) {
                            likeButton.addClass('liked');
                        } else {
                            likeButton.removeClass('liked');
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    }
                });
            });
        }

        loadPosts();
    });
</script>

	</th:block>

</body>

</html>